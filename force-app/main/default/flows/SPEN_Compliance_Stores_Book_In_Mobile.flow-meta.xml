<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <assignments>
        <description>Add the current loop item&apos;s text template to the output text variable for display on the results screen.</description>
        <name>Add_Record_Details_to_Output_Variable</name>
        <label>Add Record Details to Output Variable</label>
        <locationX>468</locationX>
        <locationY>1532</locationY>
        <assignmentItems>
            <assignToReference>loopedOutput</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>templateRecordDetails</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_recordIdsCollection_for_Display</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Add the current loop item&apos;s text template to the output text variable for display on the results screen.</description>
        <name>Add_templateRecordDetails_to_loopedFinalOutput</name>
        <label>Add templateRecordDetails to loopedFinalOutput</label>
        <locationX>270</locationX>
        <locationY>4628</locationY>
        <assignmentItems>
            <assignToReference>loopedFinalOutput</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>templateFinalDetails</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Updated_Serialized_Products</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Adds the triggering record to the recordIdsCollection.</description>
        <name>Add_to_recordIdsCollection</name>
        <label>Add to recordIdsCollection</label>
        <locationX>512</locationX>
        <locationY>1232</locationY>
        <assignmentItems>
            <assignToReference>recordIdsCollection</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_recordIdsCollection_for_Display</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assigned the record variable to the collection. Used to create product transfer state records in the following Create Records element.</description>
        <name>Assign_Product_Transfer_States</name>
        <label>Assign Product Transfer States</label>
        <locationX>270</locationX>
        <locationY>2888</locationY>
        <assignmentItems>
            <assignToReference>productTransferStates</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>productTransferState</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Created_Product_Transfers</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assigns the product transfer that has just been created, along with the helper field to a collection. This is to loop over for the creation of product transfer state records.</description>
        <name>Assign_Record_to_Collection</name>
        <label>Assign Record to Collection</label>
        <locationX>270</locationX>
        <locationY>2480</locationY>
        <assignmentItems>
            <assignToReference>createdProductTransfers</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>createdProductTransfer</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_recordIdsCollection</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assigns the current serialised product id to the helper field. This is to associate the product transfer state to the correct serialised product.</description>
        <name>Assign_Serialized_Product_Helper</name>
        <label>Assign Serialized Product Helper</label>
        <locationX>270</locationX>
        <locationY>2372</locationY>
        <assignmentItems>
            <assignToReference>createdProductTransfer.SPEN_Serialised_Product_Helper__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CurrentItemfromLooprecordIdsCollection.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_Record_to_Collection</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assigns the required values to the product transfers record. Used to update the product transfer to accept the move.</description>
        <name>Assign_Transfer_IsReceived_and_Quantity</name>
        <label>Assign Transfer IsReceived and Quantity</label>
        <locationX>270</locationX>
        <locationY>3296</locationY>
        <assignmentItems>
            <assignToReference>updatedProductTransfer.IsReceived</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedProductTransfer.QuantityReceived</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedProductTransfer.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CurrentItemfromLoopforUpdateTransfers.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedProductTransfer.QuantityUnitOfMeasure</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Each</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_Updated_Product_Transfer</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assigned the record variable to the collection. Used in the following Update Records element.</description>
        <name>Assign_Updated_Product_Transfer</name>
        <label>Assign Updated Product Transfer</label>
        <locationX>270</locationX>
        <locationY>3404</locationY>
        <assignmentItems>
            <assignToReference>updatedProductTransfers</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>updatedProductTransfer</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_for_Update_Transfers</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assigns the record variable to a collection. Used in the following Update Records element to update the serialised products.</description>
        <name>Assign_Updated_Serialized_Products</name>
        <label>Assign Updated Serialized Products</label>
        <locationX>270</locationX>
        <locationY>3920</locationY>
        <assignmentItems>
            <assignToReference>updatedSerializedProducts</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>updatedSerializedProduct</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_recordIdsCollection_for_Update</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assigned required values to the product transfer state record variable.</description>
        <name>Assignment_for_Create_Product_Transfer_States</name>
        <label>Assignment for Create Product Transfer States</label>
        <locationX>270</locationX>
        <locationY>2780</locationY>
        <assignmentItems>
            <assignToReference>productTransferState.Action</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Receive</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransferState.ProductTransferId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CurrentItemFromLoopCreatedProductTransfers.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransferState.TransferState</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Sent</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransferState.SerializedProductId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CurrentItemFromLoopCreatedProductTransfers.SPEN_Serialised_Product_Helper__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_Product_Transfer_States</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assigns updated values to the serialised product record variable. Used to update serialised products after they have been moved.</description>
        <name>Assignment_for_Update_Serialized_Products</name>
        <label>Assignment for Update Serialized Products</label>
        <locationX>270</locationX>
        <locationY>3812</locationY>
        <assignmentItems>
            <assignToReference>updatedSerializedProduct.OwnerId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recordLocation.OwnerId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedSerializedProduct.SPEN_Current_Location__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recordLocation.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedSerializedProduct.SPEN_Item_Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Quarantine - Awaiting Inspection</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedSerializedProduct.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Available</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedSerializedProduct.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CurrentItemfromLooprecordIdsCollectionforUpdate.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedSerializedProduct.SPEN_Energy_Networks_ID__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CurrentItemfromLooprecordIdsCollectionforUpdate.SPEN_Energy_Networks_ID__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedSerializedProduct.SPEN_Type__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CurrentItemfromLooprecordIdsCollectionforUpdate.SPEN_Type__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedSerializedProduct.SPEN_Category__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CurrentItemfromLooprecordIdsCollectionforUpdate.SPEN_Category__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedSerializedProduct.SPEN_Location_Name__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recordLocation.Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedSerializedProduct.SPEN_Manufacturer__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CurrentItemfromLooprecordIdsCollectionforUpdate.SPEN_Manufacturer__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedSerializedProduct.SPEN_Safety_Check_Date__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CurrentItemfromLooprecordIdsCollectionforUpdate.SPEN_Safety_Check_Date__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_Updated_Serialized_Products</targetReference>
        </connector>
    </assignments>
    <decisions>
        <description>Checks if the record type returned properly or if there was an error.</description>
        <name>Check_if_Valid_Record_Type</name>
        <label>Check if Valid Record Type</label>
        <locationX>380</locationX>
        <locationY>2048</locationY>
        <defaultConnector>
            <targetReference>InvalidRecordType</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Invalid Record Type</defaultConnectorLabel>
        <rules>
            <name>Valid_Record_Type</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recordtypeProductTransfer.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_recordIdsCollection</targetReference>
            </connector>
            <label>Valid Record Type</label>
        </rules>
    </decisions>
    <decisions>
        <description>Checks if the Return Comments field was filled out.</description>
        <name>Comments_Completed</name>
        <label>Comments Completed?</label>
        <locationX>182</locationX>
        <locationY>4220</locationY>
        <defaultConnector>
            <targetReference>Loop_Updated_Serialized_Products</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes_Completed</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>inputReturnComments</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue></stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>inputReturnComments</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_Return_Comments_Note</targetReference>
            </connector>
            <label>Yes Completed</label>
        </rules>
    </decisions>
    <decisions>
        <description>Checks if the user checked the checkbox to begin the inspection process.</description>
        <name>Launch_Inspection_Subflow</name>
        <label>Launch Inspection Subflow?</label>
        <locationX>182</locationX>
        <locationY>4928</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes_Launch_Subflow</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Would_you_like_to_launch_the_inspection_process</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Launch_Self_Inspect</targetReference>
            </connector>
            <label>Yes Launch Subflow</label>
        </rules>
    </decisions>
    <decisions>
        <description>Checks if record is part of a multiset.</description>
        <name>Multiset_Check</name>
        <label>Multiset Check</label>
        <locationX>380</locationX>
        <locationY>1124</locationY>
        <defaultConnector>
            <targetReference>Add_to_recordIdsCollection</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Single Item</defaultConnectorLabel>
        <rules>
            <name>Is_MultiSet</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recordId.SPEN_Multiset__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Multiset_Sibling_Records</targetReference>
            </connector>
            <label>Is MultiSet</label>
        </rules>
    </decisions>
    <decisions>
        <description>Decides if the item is valid by recordId.ID, status, and active state.</description>
        <name>Valid_ENID</name>
        <label>Valid ENID</label>
        <locationX>380</locationX>
        <locationY>458</locationY>
        <defaultConnector>
            <targetReference>Get_Parent_Serialized_Product_from_inputENID</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Invalid</defaultConnectorLabel>
        <rules>
            <name>Invalid_ENID</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recordId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <isGoTo>true</isGoTo>
                <targetReference>Get_Parent_Serialized_Product_from_inputENID</targetReference>
            </connector>
            <label>Invalid ENID</label>
        </rules>
        <rules>
            <name>ValidENID</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recordId.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>recordId.SPEN_Item_Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Booked Out</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>recordId.SPEN_Active__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Multiset_Check</targetReference>
            </connector>
            <label>Valid ENID</label>
        </rules>
    </decisions>
    <decisions>
        <description>Decides if the item is valid by recordId.ID, status, and active state.</description>
        <name>Valid_Parent_ENID</name>
        <label>Valid Parent ENID</label>
        <locationX>710</locationX>
        <locationY>674</locationY>
        <defaultConnector>
            <targetReference>InvalidENID</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Invalid</defaultConnectorLabel>
        <rules>
            <name>Invalid_Parent_ENID</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recordId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <isGoTo>true</isGoTo>
                <targetReference>InvalidENID</targetReference>
            </connector>
            <label>Invalid Parent ENID</label>
        </rules>
        <rules>
            <name>ValidENID_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recordId.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>recordId.SPEN_Item_Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Booked Out</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>recordId.SPEN_Active__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Multiset_Check</targetReference>
            </connector>
            <label>Valid ENID</label>
        </rules>
    </decisions>
    <description>Flow to allow Field Service Mobile app users to book in items back to a store. Creates product transfers, product transfer states, updates product transfers, and updates serialised products. Items are booked back in to their base location quarantine area automatically.</description>
    <environments>Default</environments>
    <interviewLabel>Compliance Stores - Book In {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Compliance Stores - Book In</label>
    <loops>
        <description>Loops the created product transfers to create product transfer states.</description>
        <name>Loop_Created_Product_Transfers</name>
        <label>Loop Created Product Transfers</label>
        <locationX>182</locationX>
        <locationY>2672</locationY>
        <assignNextValueToReference>CurrentItemFromLoopCreatedProductTransfers</assignNextValueToReference>
        <collectionReference>createdProductTransfers</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Assignment_for_Create_Product_Transfer_States</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Create_Product_Transfer_State_Records</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loops the previously created product transfers. Used to update the transfers to receive the items.</description>
        <name>Loop_for_Update_Transfers</name>
        <label>Loop for Update Transfers</label>
        <locationX>182</locationX>
        <locationY>3188</locationY>
        <assignNextValueToReference>CurrentItemfromLoopforUpdateTransfers</assignNextValueToReference>
        <collectionReference>createdProductTransfers</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Assign_Transfer_IsReceived_and_Quantity</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_Product_Transfer_Record</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loops the collection of items to create product transfers.</description>
        <name>Loop_recordIdsCollection</name>
        <label>Loop recordIdsCollection</label>
        <locationX>182</locationX>
        <locationY>2156</locationY>
        <assignNextValueToReference>CurrentItemfromLooprecordIdsCollection</assignNextValueToReference>
        <collectionReference>recordIdsCollection</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Create_Product_Transfer_Records</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Loop_Created_Product_Transfers</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loop each member of the Collection Variable of previously found Serialized Products.</description>
        <name>Loop_recordIdsCollection_for_Display</name>
        <label>Loop recordIdsCollection for Display</label>
        <locationX>380</locationX>
        <locationY>1424</locationY>
        <assignNextValueToReference>CurrentItemfromLooprecordIdsCollectionforDisplay</assignNextValueToReference>
        <collectionReference>recordIdsCollection</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Add_Record_Details_to_Output_Variable</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Get_Base_Location_Quarantine_Area</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loops the previous serialised products. Used to update the items to show new location/owner/etc.</description>
        <name>Loop_recordIdsCollection_for_Update</name>
        <label>Loop recordIdsCollection for Update</label>
        <locationX>182</locationX>
        <locationY>3704</locationY>
        <assignNextValueToReference>CurrentItemfromLooprecordIdsCollectionforUpdate</assignNextValueToReference>
        <collectionReference>recordIdsCollection</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Assignment_for_Update_Serialized_Products</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_Serialized_Products</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loop each member of the Collection Variable of the updated Serialized Products.</description>
        <name>Loop_Updated_Serialized_Products</name>
        <label>Loop Updated Serialized Products</label>
        <locationX>182</locationX>
        <locationY>4520</locationY>
        <assignNextValueToReference>CurrentItemfromLoopUpdatedSerializedProducts</assignNextValueToReference>
        <collectionReference>updatedSerializedProducts</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Add_templateRecordDetails_to_loopedFinalOutput</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>FinalConfirmation</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>FieldServiceMobile</processType>
    <recordCreates>
        <description>Creates a product transfer for each serialised product in the record collection. It is generally bad practice to perform DML operations within a loop. It is done here due to Field Service Mobile Flow restrictions. See https://help.salesforce.com/s/articleView?id=sf.mfs_flow_considerations.htm&amp;type=5 for more details.</description>
        <name>Create_Product_Transfer_Records</name>
        <label>Create Product Transfer Records</label>
        <locationX>270</locationX>
        <locationY>2264</locationY>
        <assignRecordIdToReference>createdProductTransfer.Id</assignRecordIdToReference>
        <connector>
            <targetReference>Assign_Serialized_Product_Helper</targetReference>
        </connector>
        <inputAssignments>
            <field>DestinationLocationId</field>
            <value>
                <elementReference>recordLocation.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Product2Id</field>
            <value>
                <elementReference>CurrentItemfromLooprecordIdsCollection.Product2Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>QuantityReceived</field>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>QuantitySent</field>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>QuantityUnitOfMeasure</field>
            <value>
                <stringValue>Each</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ReceivedById</field>
            <value>
                <elementReference>UserId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RecordTypeId</field>
            <value>
                <elementReference>recordtypeProductTransfer.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SPEN_Energy_Networks_ID__c</field>
            <value>
                <elementReference>CurrentItemfromLooprecordIdsCollection.SPEN_Energy_Networks_ID__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SPEN_New_Status__c</field>
            <value>
                <stringValue>Quarantine - Awaiting Inspection</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SPEN_Parent_Energy_Networks_ID__c</field>
            <value>
                <elementReference>CurrentItemfromLooprecordIdsCollection.SPEN_Parent_Energy_Networks_ID__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SPEN_Previous_Status__c</field>
            <value>
                <elementReference>CurrentItemfromLooprecordIdsCollection.SPEN_Item_Status__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SPEN_Safety_Check_Date__c</field>
            <value>
                <elementReference>CurrentItemfromLooprecordIdsCollection.SPEN_Safety_Check_Date__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SPEN_Serialised_Product_Helper__c</field>
            <value>
                <elementReference>CurrentItemfromLooprecordIdsCollection.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SPEN_Transfer_Comments__c</field>
            <value>
                <elementReference>inputReturnComments</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SPEN_Transfer_Date__c</field>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SPEN_Type__c</field>
            <value>
                <stringValue>Book In</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SourceLocationId</field>
            <value>
                <elementReference>CurrentItemfromLooprecordIdsCollection.SPEN_Current_Location__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SourceProductItemId</field>
            <value>
                <elementReference>CurrentItemfromLooprecordIdsCollection.ProductItemId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>Completed</stringValue>
            </value>
        </inputAssignments>
        <object>ProductTransfer</object>
    </recordCreates>
    <recordCreates>
        <description>Uses the collection variable to create product transfer states. Used to correctly move items.</description>
        <name>Create_Product_Transfer_State_Records</name>
        <label>Create Product Transfer State Records</label>
        <locationX>182</locationX>
        <locationY>3080</locationY>
        <connector>
            <targetReference>Loop_for_Update_Transfers</targetReference>
        </connector>
        <inputReference>productTransferStates</inputReference>
    </recordCreates>
    <recordCreates>
        <description>Creates a note record and associates it to the serialised product. Note is only created if the Return Comments field was completed.</description>
        <name>Create_Return_Comments_Note</name>
        <label>Create Return Comments Note</label>
        <locationX>50</locationX>
        <locationY>4328</locationY>
        <connector>
            <targetReference>Loop_Updated_Serialized_Products</targetReference>
        </connector>
        <inputAssignments>
            <field>Body</field>
            <value>
                <elementReference>inputReturnComments</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>IsPrivate</field>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OwnerId</field>
            <value>
                <elementReference>UserId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ParentId</field>
            <value>
                <elementReference>recordId.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Title</field>
            <value>
                <stringValue>Return Comments</stringValue>
            </value>
        </inputAssignments>
        <object>Note</object>
    </recordCreates>
    <recordLookups>
        <description>Get the quarantine area associated with the current item&apos;s base location. This is to ensure that the item is returned to both its properly location and to quarantine.</description>
        <name>Get_Base_Location_Quarantine_Area</name>
        <label>Get Base Location&apos;s Quarantine Area</label>
        <locationX>380</locationX>
        <locationY>1724</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>DisplayRecord</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Name</field>
            <operator>Contains</operator>
            <value>
                <stringValue>Quarantine</stringValue>
            </value>
        </filters>
        <filters>
            <field>SPEN_Is_Quarantine_Location__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>ParentLocationId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId.SPEN_Base_Location__c</elementReference>
            </value>
        </filters>
        <object>Location</object>
        <outputReference>recordLocation</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>Name</queriedFields>
        <queriedFields>OwnerId</queriedFields>
    </recordLookups>
    <recordLookups>
        <description>Gets all the records that share the same Parents ENID as the triggering record and stores them in the recordIdsCollection variable.</description>
        <name>Get_Multiset_Sibling_Records</name>
        <label>Get Multiset Sibling Records</label>
        <locationX>248</locationX>
        <locationY>1232</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Loop_recordIdsCollection_for_Display</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>SPEN_Parent_Energy_Networks_ID__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId.SPEN_Parent_Energy_Networks_ID__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>SPEN_Active__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>SPEN_Item_Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId.SPEN_Item_Status__c</elementReference>
            </value>
        </filters>
        <object>SerializedProduct</object>
        <outputReference>recordIdsCollection</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>SPEN_Energy_Networks_ID__c</queriedFields>
        <queriedFields>SPEN_Item_Status__c</queriedFields>
        <queriedFields>OwnerId</queriedFields>
        <queriedFields>Product2Id</queriedFields>
        <queriedFields>ProductItemId</queriedFields>
        <queriedFields>SPEN_Active__c</queriedFields>
        <queriedFields>SPEN_Base_Location__c</queriedFields>
        <queriedFields>SPEN_Base_Location_Name__c</queriedFields>
        <queriedFields>SPEN_Category__c</queriedFields>
        <queriedFields>SPEN_Comments__c</queriedFields>
        <queriedFields>SPEN_Current_Location__c</queriedFields>
        <queriedFields>SPEN_Expected_Return_Date__c</queriedFields>
        <queriedFields>SPEN_Item_Description__c</queriedFields>
        <queriedFields>SPEN_Location_Name__c</queriedFields>
        <queriedFields>SPEN_Manufacturer__c</queriedFields>
        <queriedFields>SPEN_Multiset__c</queriedFields>
        <queriedFields>SPEN_SPD_SPM__c</queriedFields>
        <queriedFields>SPEN_Type__c</queriedFields>
        <queriedFields>Status</queriedFields>
        <queriedFields>SPEN_Safety_Check_Date__c</queriedFields>
        <queriedFields>SPEN_Parent_Energy_Networks_ID__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <description>Gets records that match the input, matching the Parent ENID. Record must be active and the correct record type.</description>
        <name>Get_Parent_Serialized_Product_from_inputENID</name>
        <label>Get Parent Serialized Product from inputENID</label>
        <locationX>710</locationX>
        <locationY>566</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Valid_Parent_ENID</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>SPEN_Parent_Energy_Networks_ID__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>inputENID</elementReference>
            </value>
        </filters>
        <filters>
            <field>SPEN_Active__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>RecordTypeId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordtypeSerializedProduct.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>SPEN_Item_Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Booked Out</stringValue>
            </value>
        </filters>
        <object>SerializedProduct</object>
        <outputReference>recordId</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>SPEN_Energy_Networks_ID__c</queriedFields>
        <queriedFields>SPEN_Active__c</queriedFields>
        <queriedFields>SPEN_Item_Status__c</queriedFields>
        <queriedFields>SPEN_Multiset__c</queriedFields>
        <queriedFields>SPEN_Base_Location__c</queriedFields>
        <queriedFields>Product2Id</queriedFields>
        <queriedFields>SPEN_Safety_Check_Date__c</queriedFields>
        <queriedFields>SPEN_Current_Location__c</queriedFields>
        <queriedFields>ProductItemId</queriedFields>
        <queriedFields>SPEN_Type__c</queriedFields>
        <queriedFields>SPEN_Category__c</queriedFields>
        <queriedFields>SPEN_Base_Location_Name__c</queriedFields>
        <queriedFields>SPEN_Comments__c</queriedFields>
        <queriedFields>SPEN_Item_Description__c</queriedFields>
        <queriedFields>SPEN_Location_Name__c</queriedFields>
        <queriedFields>SPEN_Parent_Energy_Networks_ID__c</queriedFields>
        <queriedFields>OwnerId</queriedFields>
        <queriedFields>Status</queriedFields>
        <queriedFields>SPEN_SPD_SPM__c</queriedFields>
        <queriedFields>SPEN_Manufacturer__c</queriedFields>
        <queriedFields>SPEN_Blank_Date__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <description>Gets the Compliance Stores record type for use in later product transfer creation.</description>
        <name>Get_Record_Type_for_Product_Transfer</name>
        <label>Get Record Type for Product Transfer</label>
        <locationX>380</locationX>
        <locationY>1940</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Check_if_Valid_Record_Type</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>SobjectType</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>ProductTransfer</stringValue>
            </value>
        </filters>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>SPEN_Compliance_Stores</stringValue>
            </value>
        </filters>
        <object>RecordType</object>
        <outputReference>recordtypeProductTransfer</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>Name</queriedFields>
        <queriedFields>DeveloperName</queriedFields>
    </recordLookups>
    <recordLookups>
        <description>Get the Compliance Stores record type to be used in later Get Records elements.</description>
        <name>Get_Record_Type_for_Serialized_Products</name>
        <label>Get Record Type for Serialized Products</label>
        <locationX>380</locationX>
        <locationY>134</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>captureENID</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>SobjectType</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>SerializedProduct</stringValue>
            </value>
        </filters>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>SPEN_Compliance_Stores</stringValue>
            </value>
        </filters>
        <object>RecordType</object>
        <outputReference>recordtypeSerializedProduct</outputReference>
        <queriedFields>Id</queriedFields>
    </recordLookups>
    <recordLookups>
        <description>Gets records that match the input, matching the ENID. Record must be active and the correct record type.</description>
        <name>Get_Serialized_Product_from_inputENID</name>
        <label>Get Serialized Product from inputENID</label>
        <locationX>380</locationX>
        <locationY>350</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Valid_ENID</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>SPEN_Energy_Networks_ID__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>inputENID</elementReference>
            </value>
        </filters>
        <filters>
            <field>SPEN_Active__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>RecordTypeId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordtypeSerializedProduct.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>SPEN_Item_Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Booked Out</stringValue>
            </value>
        </filters>
        <object>SerializedProduct</object>
        <outputReference>recordId</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>SPEN_Energy_Networks_ID__c</queriedFields>
        <queriedFields>SPEN_Active__c</queriedFields>
        <queriedFields>SPEN_Item_Status__c</queriedFields>
        <queriedFields>SPEN_Multiset__c</queriedFields>
        <queriedFields>SPEN_Base_Location__c</queriedFields>
        <queriedFields>Product2Id</queriedFields>
        <queriedFields>SPEN_Safety_Check_Date__c</queriedFields>
        <queriedFields>SPEN_Current_Location__c</queriedFields>
        <queriedFields>ProductItemId</queriedFields>
        <queriedFields>SPEN_Type__c</queriedFields>
        <queriedFields>SPEN_Category__c</queriedFields>
        <queriedFields>SPEN_Base_Location_Name__c</queriedFields>
        <queriedFields>SPEN_Comments__c</queriedFields>
        <queriedFields>SPEN_Item_Description__c</queriedFields>
        <queriedFields>SPEN_Location_Name__c</queriedFields>
        <queriedFields>SPEN_Parent_Energy_Networks_ID__c</queriedFields>
        <queriedFields>OwnerId</queriedFields>
        <queriedFields>Status</queriedFields>
        <queriedFields>SPEN_SPD_SPM__c</queriedFields>
        <queriedFields>SPEN_Manufacturer__c</queriedFields>
        <queriedFields>SPEN_Blank_Date__c</queriedFields>
    </recordLookups>
    <recordUpdates>
        <description>Updates the previously created product transfers. Used to receive the item that has been transferred.</description>
        <name>Update_Product_Transfer_Record</name>
        <label>Update Product Transfer Record</label>
        <locationX>182</locationX>
        <locationY>3596</locationY>
        <connector>
            <targetReference>Loop_recordIdsCollection_for_Update</targetReference>
        </connector>
        <inputReference>updatedProductTransfers</inputReference>
    </recordUpdates>
    <recordUpdates>
        <description>Updates the serialised products using the collection variable from the previous loop.</description>
        <name>Update_Serialized_Products</name>
        <label>Update Serialized Products</label>
        <locationX>182</locationX>
        <locationY>4112</locationY>
        <connector>
            <targetReference>Comments_Completed</targetReference>
        </connector>
        <inputReference>updatedSerializedProducts</inputReference>
    </recordUpdates>
    <runInMode>DefaultMode</runInMode>
    <screens>
        <description>Allows the user to type in or scan an ENID.</description>
        <name>captureENID</name>
        <label>Enter Energy Networks ID</label>
        <locationX>380</locationX>
        <locationY>242</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Get_Serialized_Product_from_inputENID</targetReference>
        </connector>
        <fields>
            <name>inputENID</name>
            <dataType>String</dataType>
            <fieldText>Input or Scan Energy Networks ID:</fieldText>
            <fieldType>InputField</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <description>Display the collection variable text template and allow users to enter a return comment for the book in.</description>
        <name>DisplayRecord</name>
        <label>Display Record</label>
        <locationX>380</locationX>
        <locationY>1832</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <backButtonLabel>Cancel</backButtonLabel>
        <connector>
            <targetReference>Get_Record_Type_for_Product_Transfer</targetReference>
        </connector>
        <fields>
            <name>DisplayConfirmation</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;Confirm the return to quarantine for the following item(s):&lt;span class=&quot;ql-cursor&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>displayReturnLocation</name>
            <fieldText>&lt;p&gt;Return Location: &lt;strong&gt;{!recordLocation.Name}&lt;/strong&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>inputReturnComments</name>
            <dataType>String</dataType>
            <fieldText>Comments or Defects</fieldText>
            <fieldType>InputField</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>displayConfirmOutput</name>
            <fieldText>&lt;p&gt;{!templateOutput}&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <nextOrFinishButtonLabel>Confirm</nextOrFinishButtonLabel>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <description>Display confirmation message and updated record details of Serialize Products.</description>
        <name>FinalConfirmation</name>
        <label>Final Confirmation</label>
        <locationX>182</locationX>
        <locationY>4820</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Launch_Inspection_Subflow</targetReference>
        </connector>
        <fields>
            <name>FinalConfirmationMessage</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;The below item(s) are now booked in:&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Would_you_like_to_launch_the_inspection_process</name>
            <dataType>Boolean</dataType>
            <fieldText>Would you like to launch the inspection process?</fieldText>
            <fieldType>InputField</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>displayFinalTemplate</name>
            <fieldText>&lt;p&gt;{!templateFinalOutput}&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <description>Displays invalid item error message.</description>
        <name>InvalidENID</name>
        <label>Invalid Energy Networks ID</label>
        <locationX>930</locationX>
        <locationY>782</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <isGoTo>true</isGoTo>
            <targetReference>captureENID</targetReference>
        </connector>
        <fields>
            <name>invalidENIDMessage</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;The chosen Energy Networks ID is not valid. Please input or scan the ID for an item that is available for Book In.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <nextOrFinishButtonLabel>Retry</nextOrFinishButtonLabel>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <description>Displays an error message to the user if the record type does not return properly.</description>
        <name>InvalidRecordType</name>
        <label>Invalid Record Type</label>
        <locationX>578</locationX>
        <locationY>2156</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>invalidRecordTypeIdMessage</name>
            <fieldText>&lt;p&gt;Something has gone wrong. Please give an administrator the below details:&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Record Type ID for Product Transfer cannot be found.&lt;/strong&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <nextOrFinishButtonLabel>Retry</nextOrFinishButtonLabel>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <start>
        <locationX>254</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Get_Record_Type_for_Serialized_Products</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <subflows>
        <description>Launches Compliance Stores Self Inspect Mobile Flow.</description>
        <name>Launch_Self_Inspect</name>
        <label>Launch Self Inspect</label>
        <locationX>50</locationX>
        <locationY>5036</locationY>
        <flowName>SPEN_Compliance_Stores_Self_Inspection_Mobile</flowName>
        <inputAssignments>
            <name>SelfInspectENID</name>
            <value>
                <elementReference>recordId.SPEN_Energy_Networks_ID__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>UserId</name>
            <value>
                <elementReference>UserId</elementReference>
            </value>
        </inputAssignments>
    </subflows>
    <textTemplates>
        <description>Text template to display record details after updates. Used due to Field Service Mobile Flow limitations.</description>
        <name>templateFinalDetails</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>&lt;p&gt;&lt;u style=&quot;font-size: 14px; color: rgb(115, 115, 115);&quot;&gt;Name&lt;/u&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;background-color: rgb(255, 255, 255); font-size: 16px;&quot;&gt;  {!CurrentItemfromLoopUpdatedSerializedProducts.SPEN_Type__c}&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;u style=&quot;font-size: 14px; color: rgb(115, 115, 115);&quot;&gt;Energy Networks ID&lt;/u&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;font-size: 16px; background-color: rgb(255, 255, 255);&quot;&gt;  {!CurrentItemfromLoopUpdatedSerializedProducts.SPEN_Energy_Networks_ID__c}&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;u style=&quot;font-size: 14px; color: rgb(115, 115, 115);&quot;&gt;Manufacturer&lt;/u&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;font-size: 16px; background-color: rgb(255, 255, 255);&quot;&gt;  {!CurrentItemfromLoopUpdatedSerializedProducts.SPEN_Manufacturer__c}&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;u style=&quot;font-size: 14px; color: rgb(115, 115, 115);&quot;&gt;Current Location&lt;/u&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;font-size: 16px; background-color: rgb(255, 255, 255);&quot;&gt;  {!CurrentItemfromLoopUpdatedSerializedProducts.SPEN_Location_Name__c}&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;u style=&quot;font-size: 14px; color: rgb(115, 115, 115);&quot;&gt;Status&lt;/u&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;font-size: 16px; background-color: rgb(255, 255, 255);&quot;&gt;  {!CurrentItemfromLoopUpdatedSerializedProducts.SPEN_Item_Status__c}&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;u style=&quot;font-size: 14px; color: rgb(115, 115, 115);&quot;&gt;Safety Check Due&lt;/u&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;font-size: 16px; background-color: rgb(255, 255, 255);&quot;&gt;  {!CurrentItemfromLoopUpdatedSerializedProducts.SPEN_Safety_Check_Date__c}&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;____________________&lt;/span&gt;&lt;/p&gt;</text>
    </textTemplates>
    <textTemplates>
        <description>Text template to display record details after updates. Used due to Field Service Mobile Flow limitations.</description>
        <name>templateFinalOutput</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>&lt;p&gt;{!loopedFinalOutput}&lt;/p&gt;</text>
    </textTemplates>
    <textTemplates>
        <description>Text template to display record details after Get Records. Used due to Field Service Mobile Flow limitations.</description>
        <name>templateOutput</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>&lt;p&gt;{!loopedOutput}&lt;/p&gt;</text>
    </textTemplates>
    <textTemplates>
        <description>Text template to display record details after Get Records. Used due to Field Service Mobile Flow limitations.</description>
        <name>templateRecordDetails</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>&lt;p&gt;&lt;u style=&quot;color: rgb(115, 115, 115); font-size: 14px;&quot;&gt;Name&lt;/u&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;font-size: 16px; background-color: rgb(255, 255, 255);&quot;&gt;  {!CurrentItemfromLooprecordIdsCollectionforDisplay.SPEN_Type__c}&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;u style=&quot;color: rgb(115, 115, 115); font-size: 14px;&quot;&gt;Energy Networks ID&lt;/u&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;background-color: rgb(255, 255, 255); font-size: 16px;&quot;&gt;  {!CurrentItemfromLooprecordIdsCollectionforDisplay.SPEN_Energy_Networks_ID__c}&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;u style=&quot;color: rgb(115, 115, 115); font-size: 14px;&quot;&gt;Manufacturer&lt;/u&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;background-color: rgb(255, 255, 255); font-size: 16px;&quot;&gt;  {!CurrentItemfromLooprecordIdsCollectionforDisplay.SPEN_Manufacturer__c}&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;u style=&quot;color: rgb(115, 115, 115); font-size: 14px;&quot;&gt;Current Location&lt;/u&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;background-color: rgb(255, 255, 255); font-size: 16px;&quot;&gt;  {!CurrentItemfromLooprecordIdsCollectionforDisplay.SPEN_Location_Name__c}&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;u style=&quot;color: rgb(115, 115, 115); font-size: 14px;&quot;&gt;Status&lt;/u&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;background-color: rgb(255, 255, 255); font-size: 16px;&quot;&gt;  {!CurrentItemfromLooprecordIdsCollectionforDisplay.SPEN_Item_Status__c}&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;u style=&quot;color: rgb(115, 115, 115); font-size: 14px;&quot;&gt;Safety Check Due&lt;/u&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;background-color: rgb(255, 255, 255); font-size: 16px;&quot;&gt;  {!CurrentItemfromLooprecordIdsCollectionforDisplay.SPEN_Safety_Check_Date__c}&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;____________________&lt;/span&gt;&lt;/p&gt;</text>
    </textTemplates>
    <variables>
        <description>Record variable for product transfer. Used in loop to create product transfer state records.</description>
        <name>createdProductTransfer</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ProductTransfer</objectType>
    </variables>
    <variables>
        <description>Collection to hold product transfers. Used after loop to create product transfer state records.</description>
        <name>createdProductTransfers</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ProductTransfer</objectType>
    </variables>
    <variables>
        <description>Loop record variable for product transfer. Used in loop to create product transfer state records.</description>
        <name>CurrentItemFromLoopCreatedProductTransfers</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ProductTransfer</objectType>
    </variables>
    <variables>
        <description>Loop record variable for product transfer. Used in loop to update product transfer records.</description>
        <name>CurrentItemfromLoopforUpdateTransfers</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ProductTransfer</objectType>
    </variables>
    <variables>
        <description>Loop record variable for serialised product. Used in loop to create product transfer records.</description>
        <name>CurrentItemfromLooprecordIdsCollection</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>SerializedProduct</objectType>
    </variables>
    <variables>
        <description>Loop record variable for serialised products. Used in loop to display serialised product record details.</description>
        <name>CurrentItemfromLooprecordIdsCollectionforDisplay</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>SerializedProduct</objectType>
    </variables>
    <variables>
        <description>Loop record variable for serialised products. Used in loop to update serialised product records.</description>
        <name>CurrentItemfromLooprecordIdsCollectionforUpdate</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>SerializedProduct</objectType>
    </variables>
    <variables>
        <description>Loop record variable for serialised products. Used in loop to display updated serialised product records.</description>
        <name>CurrentItemfromLoopUpdatedSerializedProducts</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>SerializedProduct</objectType>
    </variables>
    <variables>
        <description>Input variable to capture ID of triggering record. Similar to recordId in a Screen Flow.</description>
        <name>Id</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>Text variable to hold record details after updates. Used due to Field Service Mobile Flow limitations.</description>
        <name>loopedFinalOutput</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>Text variable to hold record details after Get Records. Used due to Field Service Mobile Flow limitations.</description>
        <name>loopedOutput</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>Record variable for product transfer state. Used in loop to create product transfer state records.</description>
        <name>productTransferState</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ProductTransferState</objectType>
    </variables>
    <variables>
        <description>Collection to hold product transfer states. Used after loop to create product transfer state records.</description>
        <name>productTransferStates</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ProductTransferState</objectType>
    </variables>
    <variables>
        <description>Record variable for serialised product. Used to hold details of serialised product for validation checks and to create product transfer records.</description>
        <name>recordId</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>SerializedProduct</objectType>
    </variables>
    <variables>
        <description>Collection to hold serialised products. Used before and after loop to create product transfers and update serialised products.</description>
        <name>recordIdsCollection</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>SerializedProduct</objectType>
    </variables>
    <variables>
        <description>Record variable for location. Used to hold location details for product transfer destination as well as new location and owner for updated serialised products.</description>
        <name>recordLocation</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Location</objectType>
    </variables>
    <variables>
        <description>Record variable for product transfer record type. Used in loop to create product transfer records.</description>
        <name>recordtypeProductTransfer</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>RecordType</objectType>
    </variables>
    <variables>
        <description>Record variable for serialised product record type. Used in loop to create serialised product records.</description>
        <name>recordtypeSerializedProduct</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>RecordType</objectType>
    </variables>
    <variables>
        <description>Record variable for product transfer. Used in loop to update product transfer records.</description>
        <name>updatedProductTransfer</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ProductTransfer</objectType>
    </variables>
    <variables>
        <description>Collection to hold product transfers. Used after loop to update product transfers.</description>
        <name>updatedProductTransfers</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ProductTransfer</objectType>
    </variables>
    <variables>
        <description>Record variable for serialised product. Used in loop to update serialised product records.</description>
        <name>updatedSerializedProduct</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>SerializedProduct</objectType>
    </variables>
    <variables>
        <description>Collection to hold serialised products. Used after loop to update serialised products.</description>
        <name>updatedSerializedProducts</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>SerializedProduct</objectType>
    </variables>
    <variables>
        <description>Input variable to capture ID of running user.</description>
        <name>UserId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
