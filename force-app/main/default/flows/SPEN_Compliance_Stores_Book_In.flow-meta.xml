<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>58.0</apiVersion>
    <assignments>
        <description>Adds the triggering record to the recordIdsCollection.</description>
        <name>Add_to_recordIdsCollection</name>
        <label>Add to recordIdsCollection</label>
        <locationX>578</locationX>
        <locationY>1232</locationY>
        <assignmentItems>
            <assignToReference>recordIdsCollection</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Base_Location_Quarantine_Area</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assigns values to the record variable, and assigns the record to a collection. Used to update product transfers.</description>
        <name>Assign_Transfer_IsReceived_and_Quantity</name>
        <label>Assign Transfer IsReceived and Quantity</label>
        <locationX>270</locationX>
        <locationY>3080</locationY>
        <assignmentItems>
            <assignToReference>updatedProductTransfer.IsReceived</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedProductTransfer.QuantityReceived</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedProductTransfer.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_for_Update_Transfers.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedProductTransfers</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>updatedProductTransfer</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_for_Update_Transfers</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assigns values to the record variable, and assigns the record to a collection. Used to create product transfers.</description>
        <name>Assignment_for_Create_Product_Transfer</name>
        <label>Assignment for Create Product Transfer</label>
        <locationX>270</locationX>
        <locationY>2264</locationY>
        <assignmentItems>
            <assignToReference>productTransfer.DestinationLocationId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recordLocation.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransfer.Product2Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_recordIdsCollection.Product2Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransfer.QuantitySent</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransfer.QuantityUnitOfMeasure</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Each</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransfer.ReceivedById</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$User.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransfer.RecordTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Record_Type_for_Product_Transfer.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransfer.SPEN_Type__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Book In</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransfer.SPEN_Energy_Networks_ID__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_recordIdsCollection.SPEN_Energy_Networks_ID__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransfer.SPEN_Safety_Check_Date__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_recordIdsCollection.SPEN_Safety_Check_Date__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransfer.SourceLocationId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_recordIdsCollection.SPEN_Current_Location__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransfer.SourceProductItemId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_recordIdsCollection.ProductItemId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransfer.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Completed</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransfer.SPEN_Serialised_Product_Helper__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_recordIdsCollection.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransfer.SPEN_Transfer_Comments__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>inputReturnComments</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransfer.SPEN_Previous_Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_recordIdsCollection.SPEN_Item_Status__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransfer.SPEN_New_Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Quarantine - Awaiting Inspection</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransfer.SPEN_Transfer_Date__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransfers</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>productTransfer</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_recordIdsCollection</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assigns values to the record variable, and assigns the record to a collection. Used to create product transfer states.</description>
        <name>Assignment_for_Create_Product_Transfer_States</name>
        <label>Assignment for Create Product Transfer States</label>
        <locationX>270</locationX>
        <locationY>2672</locationY>
        <assignmentItems>
            <assignToReference>productTransferState.Action</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Receive</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransferState.ProductTransferId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Created_Product_Transfers.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransferState.TransferState</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Sent</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransferState.SerializedProductId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Created_Product_Transfers.SPEN_Serialised_Product_Helper__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>productTransferStates</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>productTransferState</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Created_Product_Transfers</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assigns values to the record variable, and assigns the record to a collection. Used to update serialised products.</description>
        <name>Assignment_for_Update_Serialized_Products</name>
        <label>Assignment for Update Serialized Products</label>
        <locationX>270</locationX>
        <locationY>3488</locationY>
        <assignmentItems>
            <assignToReference>updatedSerializedProduct.OwnerId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recordLocation.OwnerId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedSerializedProduct.SPEN_Current_Location__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recordLocation.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedSerializedProduct.SPEN_Expected_Return_Date__c</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedSerializedProduct.SPEN_Item_Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Quarantine - Awaiting Inspection</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedSerializedProduct.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Available</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedSerializedProduct.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_recordIdsCollection_for_Update.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedSerializedProduct.SPEN_Energy_Networks_ID__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_recordIdsCollection_for_Update.SPEN_Energy_Networks_ID__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedSerializedProduct.SPEN_Type__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_recordIdsCollection_for_Update.SPEN_Type__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedSerializedProduct.SPEN_Category__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_recordIdsCollection_for_Update.SPEN_Category__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedSerializedProduct.SPEN_Location_Name__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recordLocation.Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>updatedSerializedProducts</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>updatedSerializedProduct</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_recordIdsCollection_for_Update</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assigns the invalid item to a collection to display in a data table.</description>
        <name>Invalid_ENID</name>
        <label>Invalid ENID</label>
        <locationX>688</locationX>
        <locationY>674</locationY>
        <assignmentItems>
            <assignToReference>invalidProductCollection</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>InvalidENID</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>If the item is invalid, assigns the invalid item to a collection to display in a data table.</description>
        <name>Invalid_Product_Collection</name>
        <label>Invalid Product Collection</label>
        <locationX>248</locationX>
        <locationY>458</locationY>
        <assignmentItems>
            <assignToReference>invalidProductCollection</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>InvalidProduct</targetReference>
        </connector>
    </assignments>
    <decisions>
        <description>Checks if the record type returned properly or if there was an error.</description>
        <name>Check_if_Valid_Record_Type</name>
        <label>Check if Valid Record Type</label>
        <locationX>380</locationX>
        <locationY>2048</locationY>
        <defaultConnector>
            <targetReference>InvalidRecordType</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Invalid Record Type</defaultConnectorLabel>
        <rules>
            <name>Valid_Record_Type</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Record_Type_for_Product_Transfer.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_recordIdsCollection</targetReference>
            </connector>
            <label>Valid Record Type</label>
        </rules>
    </decisions>
    <decisions>
        <description>Checks if the Return Comments field was filled out.</description>
        <name>Comments_Given</name>
        <label>Comments Given?</label>
        <locationX>182</locationX>
        <locationY>3788</locationY>
        <defaultConnector>
            <targetReference>FinalConfirmation</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_Comments_Given</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>inputReturnComments</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue></stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_Return_Comments_Note</targetReference>
            </connector>
            <label>Yes Comments Given</label>
        </rules>
    </decisions>
    <decisions>
        <description>If the action is quick, checks if the item is valid for booking back in to the store.</description>
        <name>Is_Serialized_Product_Valid</name>
        <label>Is Serialized Product Valid</label>
        <locationX>160</locationX>
        <locationY>350</locationY>
        <defaultConnector>
            <targetReference>Invalid_Product_Collection</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Invalid</defaultConnectorLabel>
        <rules>
            <name>ValidProduct</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recordId.SPEN_Item_Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Booked Out</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>recordId.SPEN_Active__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Multiset_Check</targetReference>
            </connector>
            <label>Valid Product</label>
        </rules>
    </decisions>
    <decisions>
        <description>Checks if record is part of a multiset.</description>
        <name>Multiset_Check</name>
        <label>Multiset Check</label>
        <locationX>380</locationX>
        <locationY>1124</locationY>
        <defaultConnector>
            <targetReference>Add_to_recordIdsCollection</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Single Item</defaultConnectorLabel>
        <rules>
            <name>Is_MultiSet</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recordId.SPEN_Multiset__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>confirmMultisetCheck</targetReference>
            </connector>
            <label>Is MultiSet</label>
        </rules>
    </decisions>
    <decisions>
        <description>Decides if the action was quick or global by checking if the recordId variable is null.</description>
        <name>Quick_Action_or_Global_Action</name>
        <label>Quick Action or Global Action</label>
        <locationX>380</locationX>
        <locationY>242</locationY>
        <defaultConnector>
            <targetReference>captureENID</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Global Action</defaultConnectorLabel>
        <rules>
            <name>Quick_Action</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recordId.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Is_Serialized_Product_Valid</targetReference>
            </connector>
            <label>Quick Action</label>
        </rules>
    </decisions>
    <decisions>
        <description>Checks if user wishes to self inspect the booked in item.</description>
        <name>Self_Inspect</name>
        <label>Self Inspect?</label>
        <locationX>182</locationX>
        <locationY>4196</locationY>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_Self_Inspect</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Would_you_like_to_begin_the_inspection_process</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Updated_Record_ID_Info</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <description>Decides if the user wants to include all valid multiset items.</description>
        <name>Update_All_Check</name>
        <label>Update All Check</label>
        <locationX>182</locationX>
        <locationY>1340</locationY>
        <defaultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Add_to_recordIdsCollection</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>False</defaultConnectorLabel>
        <rules>
            <name>Update_All_True</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>This_item_is_part_of_a_multiset_Would_you_like_to_Book_In_all_items_in_the_set</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Multiset_Sibling_Records</targetReference>
            </connector>
            <label>Update All True</label>
        </rules>
    </decisions>
    <decisions>
        <description>Checks if the item is valid for booking back in to the store.</description>
        <name>Valid_ENID</name>
        <label>Valid ENID</label>
        <locationX>600</locationX>
        <locationY>566</locationY>
        <defaultConnector>
            <targetReference>Invalid_ENID</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Invalid</defaultConnectorLabel>
        <rules>
            <name>ValidENID</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recordId.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>recordId.SPEN_Item_Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Booked Out</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>recordId.SPEN_Active__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Multiset_Check</targetReference>
            </connector>
            <label>Valid ENID</label>
        </rules>
    </decisions>
    <description>Flow to allow desktop users to book in items back to a store. Creates product transfers, product transfer states, updates product transfers, and updates serialised products. Items are booked back in to their base location quarantine area automatically.</description>
    <environments>Default</environments>
    <interviewLabel>Compliance Stores - Book In {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Compliance Stores - Book In</label>
    <loops>
        <description>Loop created product transfer collection. Used to create product transfer states.</description>
        <name>Loop_Created_Product_Transfers</name>
        <label>Loop Created Product Transfers</label>
        <locationX>182</locationX>
        <locationY>2564</locationY>
        <collectionReference>productTransfers</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Assignment_for_Create_Product_Transfer_States</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Create_Product_Transfer_State_Records</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loop created product transfer collection. Used to update product transfers.</description>
        <name>Loop_for_Update_Transfers</name>
        <label>Loop for Update Transfers</label>
        <locationX>182</locationX>
        <locationY>2972</locationY>
        <collectionReference>productTransfers</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Assign_Transfer_IsReceived_and_Quantity</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_Product_Transfer_Record</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loops the collection of items to create product transfers.</description>
        <name>Loop_recordIdsCollection</name>
        <label>Loop recordIdsCollection</label>
        <locationX>182</locationX>
        <locationY>2156</locationY>
        <collectionReference>recordIdsCollection</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Assignment_for_Create_Product_Transfer</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Create_Product_Transfer_Records</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loop the serialised product collection. Used to update serialised products.</description>
        <name>Loop_recordIdsCollection_for_Update</name>
        <label>Loop recordIdsCollection for Update</label>
        <locationX>182</locationX>
        <locationY>3380</locationY>
        <collectionReference>recordIdsCollection</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Assignment_for_Update_Serialized_Products</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_Serialized_Products</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordCreates>
        <description>Creates a product transfer for each serialised product in the record collection.</description>
        <name>Create_Product_Transfer_Records</name>
        <label>Create Product Transfer Records</label>
        <locationX>182</locationX>
        <locationY>2456</locationY>
        <connector>
            <targetReference>Loop_Created_Product_Transfers</targetReference>
        </connector>
        <inputReference>productTransfers</inputReference>
    </recordCreates>
    <recordCreates>
        <description>Uses the collection variable to create product transfer states. Used to correctly move items.</description>
        <name>Create_Product_Transfer_State_Records</name>
        <label>Create Product Transfer State Records</label>
        <locationX>182</locationX>
        <locationY>2864</locationY>
        <connector>
            <targetReference>Loop_for_Update_Transfers</targetReference>
        </connector>
        <inputReference>productTransferStates</inputReference>
    </recordCreates>
    <recordCreates>
        <description>Creates a note record and associates it to the serialised product. Note is only created if the Return Comments field was completed.</description>
        <name>Create_Return_Comments_Note</name>
        <label>Create Return Comments Note</label>
        <locationX>50</locationX>
        <locationY>3896</locationY>
        <connector>
            <targetReference>FinalConfirmation</targetReference>
        </connector>
        <inputAssignments>
            <field>Body</field>
            <value>
                <elementReference>inputReturnComments</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>IsPrivate</field>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OwnerId</field>
            <value>
                <elementReference>$User.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ParentId</field>
            <value>
                <elementReference>recordId.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Title</field>
            <value>
                <stringValue>Return Comments</stringValue>
            </value>
        </inputAssignments>
        <object>Note</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordLookups>
        <description>Get the quarantine area associated with the current item&apos;s base location. This is to ensure that the item is returned to both its properly location and to quarantine.</description>
        <name>Get_Base_Location_Quarantine_Area</name>
        <label>Get Base Location&apos;s Quarantine Area</label>
        <locationX>380</locationX>
        <locationY>1724</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>DisplayRecord</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Name</field>
            <operator>Contains</operator>
            <value>
                <stringValue>Quarantine</stringValue>
            </value>
        </filters>
        <filters>
            <field>ParentLocationId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId.SPEN_Base_Location__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>SPEN_Is_Quarantine_Location__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <object>Location</object>
        <outputReference>recordLocation</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>Name</queriedFields>
        <queriedFields>OwnerId</queriedFields>
    </recordLookups>
    <recordLookups>
        <description>Gets all the records that share the same Parents ENID as the triggering record and stores them in the recordIdsCollection variable.</description>
        <name>Get_Multiset_Sibling_Records</name>
        <label>Get Multiset Sibling Records</label>
        <locationX>50</locationX>
        <locationY>1448</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_Base_Location_Quarantine_Area</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>SPEN_Parent_Energy_Networks_ID__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId.SPEN_Parent_Energy_Networks_ID__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>SPEN_Active__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <object>SerializedProduct</object>
        <outputReference>recordIdsCollection</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>SPEN_Item_Status__c</queriedFields>
        <queriedFields>SPEN_Active__c</queriedFields>
        <queriedFields>SPEN_Energy_Networks_ID__c</queriedFields>
        <queriedFields>SPEN_Location_Name__c</queriedFields>
        <queriedFields>SPEN_Multiset__c</queriedFields>
        <queriedFields>SPEN_Parent_Energy_Networks_ID__c</queriedFields>
        <queriedFields>SPEN_Type__c</queriedFields>
        <queriedFields>SPEN_Base_Location_Name__c</queriedFields>
        <queriedFields>Product2Id</queriedFields>
        <queriedFields>SPEN_Safety_Check_Date__c</queriedFields>
        <queriedFields>SPEN_Current_Location__c</queriedFields>
        <queriedFields>ProductItemId</queriedFields>
        <queriedFields>SPEN_Category__c</queriedFields>
        <queriedFields>SPEN_Base_Location__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <description>Gets the Compliance Stores record type for use in later product transfer creation.</description>
        <name>Get_Record_Type_for_Product_Transfer</name>
        <label>Get Record Type for Product Transfer</label>
        <locationX>380</locationX>
        <locationY>1940</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Check_if_Valid_Record_Type</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>SobjectType</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>ProductTransfer</stringValue>
            </value>
        </filters>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>SPEN_Compliance_Stores</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>RecordType</object>
        <queriedFields>Id</queriedFields>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Get the Compliance Stores record type to be used in later Get Records elements.</description>
        <name>Get_Record_Type_for_Serialized_Products</name>
        <label>Get Record Type for Serialized Products</label>
        <locationX>380</locationX>
        <locationY>134</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Quick_Action_or_Global_Action</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>SobjectType</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>SerializedProduct</stringValue>
            </value>
        </filters>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>SPEN_Compliance_Stores</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>RecordType</object>
        <queriedFields>Id</queriedFields>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Gets records that match the input, matching the ENID. Record must be active and the correct record type.</description>
        <name>Get_Serialized_Product_from_inputENID</name>
        <label>Get Serialized Product from inputENID</label>
        <locationX>600</locationX>
        <locationY>458</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Valid_ENID</targetReference>
        </connector>
        <filterLogic>(1 OR 2) AND 3 AND 4</filterLogic>
        <filters>
            <field>SPEN_Energy_Networks_ID__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>inputENID</elementReference>
            </value>
        </filters>
        <filters>
            <field>SPEN_Parent_Energy_Networks_ID__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>inputENID</elementReference>
            </value>
        </filters>
        <filters>
            <field>SPEN_Active__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>RecordTypeId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_Record_Type_for_Serialized_Products.Id</elementReference>
            </value>
        </filters>
        <object>SerializedProduct</object>
        <outputReference>recordId</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>SPEN_Item_Status__c</queriedFields>
        <queriedFields>SPEN_Active__c</queriedFields>
        <queriedFields>SPEN_Energy_Networks_ID__c</queriedFields>
        <queriedFields>SPEN_Location_Name__c</queriedFields>
        <queriedFields>SPEN_Multiset__c</queriedFields>
        <queriedFields>SPEN_Parent_Energy_Networks_ID__c</queriedFields>
        <queriedFields>SPEN_Type__c</queriedFields>
        <queriedFields>SPEN_Base_Location_Name__c</queriedFields>
        <queriedFields>Product2Id</queriedFields>
        <queriedFields>SPEN_Safety_Check_Date__c</queriedFields>
        <queriedFields>SPEN_Current_Location__c</queriedFields>
        <queriedFields>ProductItemId</queriedFields>
        <queriedFields>SPEN_Category__c</queriedFields>
        <queriedFields>SPEN_Base_Location__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <description>Gets the serialised product stored in the recordId variable. Used to pass the record to the Inspection flow.</description>
        <name>Get_Updated_Record_ID_Info</name>
        <label>Get Updated Record ID Info</label>
        <locationX>50</locationX>
        <locationY>4304</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Invoke_Inspection_Flow</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>SerializedProduct</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <description>Updates the previously created product transfers. Used to receive the item that has been transferred.</description>
        <name>Update_Product_Transfer_Record</name>
        <label>Update Product Transfer Record</label>
        <locationX>182</locationX>
        <locationY>3272</locationY>
        <connector>
            <targetReference>Loop_recordIdsCollection_for_Update</targetReference>
        </connector>
        <inputReference>updatedProductTransfers</inputReference>
    </recordUpdates>
    <recordUpdates>
        <description>Updates the serialised products using the collection variable from the previous loop.</description>
        <name>Update_Serialized_Products</name>
        <label>Update Serialized Products</label>
        <locationX>182</locationX>
        <locationY>3680</locationY>
        <connector>
            <targetReference>Comments_Given</targetReference>
        </connector>
        <inputReference>updatedSerializedProducts</inputReference>
    </recordUpdates>
    <runInMode>SystemModeWithoutSharing</runInMode>
    <screens>
        <description>If the action is global, allows the user to type in or scan an ENID.</description>
        <name>captureENID</name>
        <label>Enter Energy Networks ID</label>
        <locationX>600</locationX>
        <locationY>350</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Get_Serialized_Product_from_inputENID</targetReference>
        </connector>
        <fields>
            <name>inputENID</name>
            <dataType>String</dataType>
            <fieldText>Input or Scan Energy Networks ID:</fieldText>
            <fieldType>InputField</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
        </fields>
        <nextOrFinishButtonLabel>Enter Booking Information</nextOrFinishButtonLabel>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <description>Screen to display the option to Book In all items in the multiset.</description>
        <name>confirmMultisetCheck</name>
        <label>Multiset Check</label>
        <locationX>182</locationX>
        <locationY>1232</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Update_All_Check</targetReference>
        </connector>
        <fields>
            <name>displayENIDs</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;Energy Networks ID: &lt;/span&gt;&lt;strong style=&quot;font-size: 14px;&quot;&gt;{!recordId.SPEN_Energy_Networks_ID__c}&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;Parent Energy Networks ID: &lt;/span&gt;&lt;strong style=&quot;font-size: 14px;&quot;&gt;{!recordId.SPEN_Parent_Energy_Networks_ID__c}&lt;/strong&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>This_item_is_part_of_a_multiset_Would_you_like_to_Book_In_all_items_in_the_set</name>
            <dataType>Boolean</dataType>
            <fieldText>This item is part of a multiset. Would you like to Book In all items in the set?</fieldText>
            <fieldType>InputField</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <description>Display the collection variable in a data table and allow users to enter a return comment for the book in.</description>
        <name>DisplayRecord</name>
        <label>Display Record</label>
        <locationX>380</locationX>
        <locationY>1832</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <backButtonLabel>Cancel</backButtonLabel>
        <connector>
            <targetReference>Get_Record_Type_for_Product_Transfer</targetReference>
        </connector>
        <fields>
            <name>DisplayConfirmation</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;Confirm the return to quarantine for the following item(s):&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>displayReturnLocation</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;Return Location: &lt;/span&gt;&lt;strong style=&quot;font-size: 14px;&quot;&gt;{!recordLocation.Name}&lt;/strong&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>inputReturnComments</name>
            <dataType>String</dataType>
            <fieldText>Comments or Defects</fieldText>
            <fieldType>InputField</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>confirmItemsTable</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>SerializedProduct</typeValue>
            </dataTypeMappings>
            <extensionName>flowruntime:datatable</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Confirm Items</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>selectionMode</name>
                <value>
                    <stringValue>NO_SELECTION</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>minRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>recordIdsCollection</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columns</name>
                <value>
                    <stringValue>[{&quot;apiName&quot;:&quot;SPEN_Energy_Networks_ID__c&quot;,&quot;guid&quot;:&quot;column-1b04&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:0,&quot;label&quot;:&quot;Energy Networks ID&quot;,&quot;type&quot;:&quot;customRichText&quot;},{&quot;apiName&quot;:&quot;SPEN_Type__c&quot;,&quot;guid&quot;:&quot;column-8229&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:1,&quot;label&quot;:&quot;Type&quot;,&quot;type&quot;:&quot;customRichText&quot;},{&quot;apiName&quot;:&quot;SPEN_Location_Name__c&quot;,&quot;guid&quot;:&quot;column-53be&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Current Location&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:2,&quot;label&quot;:&quot;Location Name&quot;,&quot;type&quot;:&quot;customRichText&quot;},{&quot;apiName&quot;:&quot;SPEN_Base_Location_Name__c&quot;,&quot;guid&quot;:&quot;column-a47d&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Base Location&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:3,&quot;label&quot;:&quot;Base Location Name&quot;,&quot;type&quot;:&quot;customRichText&quot;},{&quot;apiName&quot;:&quot;SPEN_Item_Status__c&quot;,&quot;guid&quot;:&quot;column-85f9&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:4,&quot;label&quot;:&quot;Item Status&quot;,&quot;type&quot;:&quot;text&quot;}]</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>maxRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>isShowSearchBar</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <nextOrFinishButtonLabel>Confirm</nextOrFinishButtonLabel>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <description>Display confirmation message and updated record details of Serialized Products. Asks the user if they want to begin the inspection process.</description>
        <name>FinalConfirmation</name>
        <label>Final Confirmation</label>
        <locationX>182</locationX>
        <locationY>4088</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Self_Inspect</targetReference>
        </connector>
        <fields>
            <name>FinalConfirmationMessage</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;The below item(s) are now booked in:&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Would_you_like_to_begin_the_inspection_process</name>
            <dataType>Boolean</dataType>
            <fieldText>Would you like to begin the inspection process?</fieldText>
            <fieldType>InputField</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>tableFinalUpdatedProducts</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>SerializedProduct</typeValue>
            </dataTypeMappings>
            <extensionName>flowruntime:datatable</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Updated Products</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>selectionMode</name>
                <value>
                    <stringValue>NO_SELECTION</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>minRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>updatedSerializedProducts</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columns</name>
                <value>
                    <stringValue>[{&quot;apiName&quot;:&quot;SPEN_Energy_Networks_ID__c&quot;,&quot;guid&quot;:&quot;column-1b2a&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:0,&quot;label&quot;:&quot;Energy Networks ID&quot;,&quot;type&quot;:&quot;customRichText&quot;},{&quot;apiName&quot;:&quot;SPEN_Type__c&quot;,&quot;guid&quot;:&quot;column-058b&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Product Name&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:1,&quot;label&quot;:&quot;Type&quot;,&quot;type&quot;:&quot;customRichText&quot;},{&quot;apiName&quot;:&quot;SPEN_Category__c&quot;,&quot;guid&quot;:&quot;column-0cc5&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:2,&quot;label&quot;:&quot;Category&quot;,&quot;type&quot;:&quot;customRichText&quot;},{&quot;apiName&quot;:&quot;SPEN_Item_Status__c&quot;,&quot;guid&quot;:&quot;column-97fd&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:3,&quot;label&quot;:&quot;Item Status&quot;,&quot;type&quot;:&quot;text&quot;},{&quot;apiName&quot;:&quot;SPEN_Location_Name__c&quot;,&quot;guid&quot;:&quot;column-977d&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:4,&quot;label&quot;:&quot;Location Name&quot;,&quot;type&quot;:&quot;customRichText&quot;}]</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>maxRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>isShowSearchBar</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <nextOrFinishButtonLabel>Finish</nextOrFinishButtonLabel>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <description>Displays details about the invalid item in a data table.</description>
        <name>InvalidENID</name>
        <label>Invalid Item</label>
        <locationX>688</locationX>
        <locationY>782</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <isGoTo>true</isGoTo>
            <targetReference>captureENID</targetReference>
        </connector>
        <fields>
            <name>invalidENIDMessage</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;The chosen Energy Networks ID is not valid. Please input or scan the ID for an item that is available for Book In. See below for more information.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>invalidENIDInformation</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>SerializedProduct</typeValue>
            </dataTypeMappings>
            <extensionName>flowruntime:datatable</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Item Information</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>selectionMode</name>
                <value>
                    <stringValue>MULTI_SELECT</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>minRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>invalidProductCollection</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columns</name>
                <value>
                    <stringValue>[{&quot;apiName&quot;:&quot;SPEN_Energy_Networks_ID__c&quot;,&quot;guid&quot;:&quot;column-749a&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:0,&quot;label&quot;:&quot;Energy Networks ID&quot;,&quot;type&quot;:&quot;customRichText&quot;},{&quot;apiName&quot;:&quot;SPEN_Item_Status__c&quot;,&quot;guid&quot;:&quot;column-772e&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:1,&quot;label&quot;:&quot;Item Status&quot;,&quot;type&quot;:&quot;text&quot;},{&quot;apiName&quot;:&quot;SPEN_Location_Name__c&quot;,&quot;guid&quot;:&quot;column-b625&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Current Location&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:2,&quot;label&quot;:&quot;Location Name&quot;,&quot;type&quot;:&quot;customRichText&quot;},{&quot;apiName&quot;:&quot;SPEN_Active__c&quot;,&quot;guid&quot;:&quot;column-32ad&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:3,&quot;label&quot;:&quot;Active&quot;,&quot;type&quot;:&quot;boolean&quot;}]</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <nextOrFinishButtonLabel>Retry</nextOrFinishButtonLabel>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <description>Displays details about the invalid item in a data table.</description>
        <name>InvalidProduct</name>
        <label>Invalid Item</label>
        <locationX>248</locationX>
        <locationY>566</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>invalidProductMessage</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;font-size: 14px; background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt;The chosen item is not valid. Please choose an item that is available for Book In. See below for more information.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>invalidProductInformation</name>
            <dataTypeMappings>
                <typeName>T</typeName>
                <typeValue>SerializedProduct</typeValue>
            </dataTypeMappings>
            <extensionName>flowruntime:datatable</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Item Information</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>selectionMode</name>
                <value>
                    <stringValue>NO_SELECTION</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>minRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>tableData</name>
                <value>
                    <elementReference>invalidProductCollection</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>maxRowSelection</name>
                <value>
                    <numberValue>0.0</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>columns</name>
                <value>
                    <stringValue>[{&quot;apiName&quot;:&quot;SPEN_Energy_Networks_ID__c&quot;,&quot;guid&quot;:&quot;column-24db&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:0,&quot;label&quot;:&quot;Energy Networks ID&quot;,&quot;type&quot;:&quot;customRichText&quot;},{&quot;apiName&quot;:&quot;SPEN_Item_Status__c&quot;,&quot;guid&quot;:&quot;column-baee&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:1,&quot;label&quot;:&quot;Item Status&quot;,&quot;type&quot;:&quot;text&quot;},{&quot;apiName&quot;:&quot;SPEN_Location_Name__c&quot;,&quot;guid&quot;:&quot;column-5d18&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Current Location&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:2,&quot;label&quot;:&quot;Location Name&quot;,&quot;type&quot;:&quot;customRichText&quot;},{&quot;apiName&quot;:&quot;SPEN_Active__c&quot;,&quot;guid&quot;:&quot;column-189e&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:3,&quot;label&quot;:&quot;Active&quot;,&quot;type&quot;:&quot;boolean&quot;}]</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <nextOrFinishButtonLabel>Finish</nextOrFinishButtonLabel>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <description>Displays an error message to the user if the record type does not return properly.</description>
        <name>InvalidRecordType</name>
        <label>Invalid Record Type</label>
        <locationX>578</locationX>
        <locationY>2156</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>Copy_1_of_invalidENIDMessage</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;Something has gone wrong. A valid record type can not be found. Please give an administrator the below details:&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Record Type Id for Product Transfer cannot be found.&lt;/strong&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <nextOrFinishButtonLabel>Retry</nextOrFinishButtonLabel>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <start>
        <locationX>254</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Get_Record_Type_for_Serialized_Products</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <subflows>
        <description>Launches the Inspection flow as a subflow. Used to allow competent users to immediately inspection items that have been booked in to the store.</description>
        <name>Invoke_Inspection_Flow</name>
        <label>Invoke Inspection Flow</label>
        <locationX>50</locationX>
        <locationY>4412</locationY>
        <flowName>SPEN_Compliance_Stores_Inspection</flowName>
        <inputAssignments>
            <name>recordId</name>
            <value>
                <elementReference>Get_Updated_Record_ID_Info</elementReference>
            </value>
        </inputAssignments>
    </subflows>
    <variables>
        <description>Collection to display invalid item details.</description>
        <name>invalidProductCollection</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>SerializedProduct</objectType>
    </variables>
    <variables>
        <description>Record variable for product transfer. Used in loop to create product transfer.</description>
        <name>productTransfer</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ProductTransfer</objectType>
    </variables>
    <variables>
        <description>Collection to hold product transfers. Used after loop to create product transfers.</description>
        <name>productTransfers</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ProductTransfer</objectType>
    </variables>
    <variables>
        <description>Record variable for product transfer state. Used in loop to create product transfer state record.</description>
        <name>productTransferState</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ProductTransferState</objectType>
    </variables>
    <variables>
        <description>Collection to hold product transfer states. Used after loop to create product transfer state records.</description>
        <name>productTransferStates</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ProductTransferState</objectType>
    </variables>
    <variables>
        <description>Record variable for serialised product. Used as input to capture quick action record details.</description>
        <name>recordId</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>SerializedProduct</objectType>
    </variables>
    <variables>
        <description>Collection to hold serialised products. Used before and after loop to create product transfers and update serialised products.</description>
        <name>recordIdsCollection</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>SerializedProduct</objectType>
    </variables>
    <variables>
        <description>Record variable for location. Used to assign location id and owner to product transfers and serialised products.</description>
        <name>recordLocation</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Location</objectType>
    </variables>
    <variables>
        <description>Record variable for product transfer. Used in loop to update product transfer state records.</description>
        <name>updatedProductTransfer</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ProductTransfer</objectType>
    </variables>
    <variables>
        <description>Collection to hold product transfers. Used after loop to update product transfers.</description>
        <name>updatedProductTransfers</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ProductTransfer</objectType>
    </variables>
    <variables>
        <description>Record variable for serialised product. Used in loop to create serialised product records.</description>
        <name>updatedSerializedProduct</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>SerializedProduct</objectType>
    </variables>
    <variables>
        <description>Collection to hold serialised products. Used after loop to update serialised products.</description>
        <name>updatedSerializedProducts</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>SerializedProduct</objectType>
    </variables>
</Flow>
