/*-----------------------------------------------------------------------------
DESCRIPTION	:	Selector Class for the PSR Custom UI
LIBRARY		:	Salesforce Enterprise Library - 
VERSION		:	1.0
HISTORY		:
Date			Author		    Comment
OCT-27-2022		Ayush Mittal     Initial version
-----------------------------------------------------------------------------*/
public with sharing class SPEN_PSRVulnerabilitySelector 
{
    public static List<SPEN_PSRVulnerabilityType__c> getVulnerabilityList() 
    {
        List<SPEN_PSRVulnerabilityType__c> psrVul = [SELECT Id, Name, SPEN_Code__c, SPEN_Description__c,
                                                            SPEN_SpecificVulnerability__c,SPEN_Priority__c, 
                                                            SPEN_Active__c from SPEN_PSRVulnerabilityType__c
                                                            WHERE SPEN_Active__c = true
                                                            WITH SECURITY_ENFORCED 
                                                            LIMIT :(Limits.getLimitQueryRows()-Limits.getQueryRows())];
        return psrVul;
    }
    public static List<SPEN_PSRVulnerabilityType__c> getCodeForSyncPSRBatchService(Set<String> vulCodeSet){
        List<SPEN_PSRVulnerabilityType__c> psrVulCodeList = new List<SPEN_PSRVulnerabilityType__c>();
        psrVulCodeList = [Select Id,SPEN_Code__c
                          FROM SPEN_PSRVulnerabilityType__c
                          WHERE SPEN_Code__c IN: vulCodeSet
                          WITH SECURITY_ENFORCED];
        return psrVulCodeList;
    }
    public List<SPEN_PSRVulnerabilityType__c> getCodeForBeforeTrigger(Set<String> vulCodeSet){
        List<SPEN_PSRVulnerabilityType__c> psrVulCodeList = new List<SPEN_PSRVulnerabilityType__c>();
        if(!vulCodeSet.isEmpty())
        {
            psrVulCodeList = [SELECT Id,SPEN_Code__c
                                FROM SPEN_PSRVulnerabilityType__c
                                WHERE Id IN: vulCodeSet
                                WITH SECURITY_ENFORCED];
        }
        
        return psrVulCodeList;
    }
}