@IsTest
public class SPEN_PSRVulnerabilitySelectorTEST {
	@IsTest
    private static void testgetVulnerabilityList(){
        Id profileId = SPEN_TestDataFactory.getProfile(SPEN_TestDataFactoryConstants.PROFILENAME);
        User user = SPEN_TestDataFactory.settestUser(SPEN_TestDataFactoryConstants.PROFILENAME);
        Database.insert(user);
        PermissionSet ps = [SELECT Id FROM PermissionSet WHERE Name = 'SPEN_PSRVulnerabilityTypeAccessCRU'];
		insert new PermissionSetAssignment(AssigneeId = user.id, PermissionSetId = ps.Id); 
        System.runAs(user)
        {
            
        list<SPEN_PSRVulnerabilityType__c> psrv=SPEN_TestDataFactory.createPSRVulnerabilityRecords();
        insert psrv;
        Set<String> vulCodeId = new Set<String>();
        for(SPEN_PSRVulnerabilityType__c psr: psrv)
        	vulCodeId.add(String.valueOf(psr.id));
            
        Test.startTest();
        List<SPEN_PSRVulnerabilityType__c> psrvu=SPEN_PSRVulnerabilitySelector.getVulnerabilityList();
        Assert.isNotNull(psrv[0].Id);
        List<SPEN_PSRVulnerabilityType__c> lstPsrVul = SPEN_PSRVulnerabilitySelector.getCodeForSyncPSRBatchService(vulCodeId);
        List<SPEN_PSRVulnerabilityType__c> lstPsrVul2 = new SPEN_PSRVulnerabilitySelector().getCodeForBeforeTrigger(vulCodeId);
        Test.stopTest();
    	}
	}
    
}